<html>
<head>
	<meta charset="UTF-8">
<script src="https://web-chat.global.assistant.watson.appdomain.cloud/loadWatsonAssistantChat.js"></script>
<script>
  window.loadWatsonAssistantChat({
    integrationID: "fa69c236-288a-4c1d-92ed-5c134b93e8e7", // The ID of this integration.
		openChatByDefault: true,
		carbonTheme: 'g10',
    region: "eu-de" // The region your integration is hosted in.
  }).then(function(instance){
		const customLanguagePack = {
	    "input_placeholder": "Введите ваш вопрос...",
	    "options_select": "Выберите ваш вариант",
			"options_seeMore": "Посмотреть другие опции"
	  };
		/**
 * Console out the context object.
 */

 function loadJSONSync(url, data)
{
  var xmlhttp=new XMLHttpRequest();
  xmlhttp.open("POST",url,false);
  xmlhttp.setRequestHeader("Content-Type", "application/json");

  xmlhttp.send('{ "text":"'+data+'"}');
  if (xmlhttp.status==200)
  {
    return JSON.parse(xmlhttp.responseText);
  }
  else {
    // TODO Throw exception
    return null;
  }
}
function handler(event) {
	var myData = event.data.input['text'];
	if (myData!="") {
			var answer = loadJSONSync('http://9.220.198.214:5999/spell_text',myData);
			if (answer!=null ) {
				event.data.input.text=answer.spelling_text;
				console.log("answer.text=",answer.text);
				console.log("answer.spelling_text=",answer.spelling_text);
			}
	}
}
instance.on({ type: "pre:send", handler: handler });
	  instance.updateLanguagePack(customLanguagePack);
    instance.render();
  });
</script>
</head>
<body>

</body>
</html>
